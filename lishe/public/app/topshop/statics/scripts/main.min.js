function isBody(a){return/^(?:body|html)$/i.test(a.tagName)}function getCompatElement(){var a=document;return a.compatMode&&"CSS1Compat"!=a.compatMode?a.body:a.html}document.head=document.head||document.getElementsByTagName("head")[0];function isElement(a){a=a[0]||a;return a.nodeName&&1===a.nodeType}function substitute(a,c){return String(a).replace(/\\?\{([^{}]+)\}/g,function(a,f){return"\\"===a.charAt(0)?a.slice(1):null!=c[f]?c[f]:""})}
function checkAll(a,c){$(c).prop("checked",$(a).prop("checked"))}$.fn.outerHtml=function(){if("outerHTML"in document.body){var a="";this.each(function(c){a+=this.outerHTML});return a}return $("<div>").append(this.clone(!0,!0)).html()};
$.fn.patch=function(a){var c=this,b;b=a?$.makeArray(a):["margin","padding","border"];var f={x:0,y:0};$.each({x:["left","right"],y:["top","bottom"]},function(a,e){$.each(e,function(e,k){try{$.each(b,function(b,e){e+="-"+k;0==e.indexOf("border")&&(e+="-width");f[a]+=parseInt(c.css(e))||0})}catch(l){}})});return f};
$.fn.locate=function(a){a=$.extend({relative:document.body,x:"center",y:"center"},a);var c=$(a.relative),b,f=$(this).css("position","absolute"),d=f.height();b=f.width();var e=(c.is("body")?$(window):c).innerHeight(),g=c.innerWidth();switch(a.x){case 0:case "left":b=0;break;case "right":b=g-b;break;default:b=parseInt((g-b)/2)}switch(a.y){case 0:case "top":a=0;break;case "bottom":a=e-d;break;default:a=parseInt((e-d)/2)}f.css({left:Math.max(0,Math.floor(b+(c.offset()?c.offset().left:0)+c.scrollLeft())),
top:Math.max(0,Math.floor(a+(c.offset()?c.offset().top:0)+c.scrollTop()))});return this};
var Class=function(a){var c=function(){"function"===typeof this.init&&this.init.apply(this,arguments)};c.prototype=a||{};c.prototype.setOptions=function(){this.options=$.extend.apply(null,[!0,{},this.options].concat($.makeArray(arguments)));return this};c.prototype.trigger=function(a,f){a=this.options[a]||this.options["on"+a.replace(/^[a-z]/g,function(a){return a.toUpperCase()})];"function"===typeof a&&a.apply(this,$.makeArray(f));return this};return c};
(function(){var a,c,b=window.console;window.log=a=function(){c.push(arguments);b?b.log[b.firebug?"apply":"call"](b,Array.prototype.slice.call(arguments)):alert(Array.prototype.slice.call(arguments).join("\n"))};a.history=c=[]})();var imageUpload=function(a){a=$.extend({url:"",target:document.body,fileName:"upload_files",inputName:"images[]",size:512E3,width:50,height:50,multiple:!0,isModal:!1,limit:0,handle:".action-upload",file_input:".action-file-input",insertWhere:null,callback:null},a||{});$(a.target).on("click",a.handle,function(c){$(this).parent().find(a.file_input).click()}).on("change",a.file_input,function(c){var b=$(this);c=b.parent();var f=c.find(a.handle),d=this.getAttribute("data-filename")||a.fileName,e=this.getAttribute("data-size"),
e=Number(e)||a.size,g=c.find(this.getAttribute("data-insertwhere")||a.insertWhere||".image-box"),k=this.multiple,l=this.getAttribute("data-ismodal"),n=this.getAttribute("data-remote")||a.url,p=this.getAttribute("data-max")||a.limit,q=this.getAttribute("name")||a.inputName,y=this.getAttribute("data-callback")||b.data("callback")||a.callback,s=new FormData,r=this.files;if(p&&c.find(".img-thumbnail:not(.action-upload)").length+(k&&r?r.length:1)>p)return alert("超出限制，最多上传"+p+"张。"),!1;if(!r||!Array.prototype.slice.call(r).every(function(a,
f){if(a.size>e)return $("#messagebox").message('抱歉，上传图片 "'+a.name+'" 须小于'+e/1024+"kB!"),b.val(""),!1;k?s.append(d+"[]",a):s.append(d,a);return!0}))return!1;$.ajax({url:n,type:"POST",data:s,cache:!1,contentType:!1,processData:!1,success:function(a){try{a=JSON.parse(a)}catch(c){}if(a.success&&a.data){if(y)return y(a);var e="";if(k)if(l){$("#areaselect_modal").modal("hide");a=$(".nav-tabs .active").attr("data-type");var p=$(".has-searched")?$(".has-searched").val():"",h=$(".gallery-condition .active").hasClass("time")?
$(".gallery-condition .active").attr("data-order")+" "+$(".gallery-condition .active").attr("data-sort"):$(".gallery-condition .active").attr("data-order");getList(a,h,p)}else g=f,$.each(a.data,function(a,f){f.url&&(e+='<div class="handle img-thumbnail"><i class="icon-close-b" onclick="$(this).parent().remove();"></i><img src="'+f.url+'"><input type="hidden" name="'+q+'" value="'+f.url+'"></div>')}),$(e).insertBefore(g);else a=a.data[d],a.url&&(e='<img src="'+a.url+'"><input type="hidden" name="'+
q+'" value="'+a.url+'">'),$(g).html(e)}else a.message&&($("#messagebox").message(a.message),b.val(""))},error:function(){$("#messagebox").message("上传出错，请重试")}})})};
jQuery(function(){imageUpload();var a,c,b,f,d;$("#gallery_modal").on("show.bs.modal",function(e){$(this);a=$(e.relatedTarget);c=a.attr("data-limit");b=a.attr("data-isMultiple");f=a.attr("data-name");a.parents(".multiple-upload").find(".multiple-item");d=a.parent().find(".multiple-item");console.log(b)});$("#gallery_modal").on("click",".action-save",function(){var e=$("#gallery_modal").find(".checked"),g=e.find("img").attr("src"),k=e.find(".caption").attr("data-name"),g='<img src="'+g+'">';if(b&&"true"==
b){var l="";$(e).each(function(a,b){l+='<div class="multiple-item"><div class="multiple-del glyphicon glyphicon-remove-circle"></div><a class="select-image"><input type="hidden" name="'+f+'" value="'+$(b).find(".caption").attr("data-name")+'"><div class="img-put"><img src="'+$(b).find("img").attr("src")+'"><i class="glyphicon glyphicon-picture"></i></div></a></div>'});0==e.length?$("#messagebox").message("请选择图片!"):e.length>c?$("#messagebox").message("您选择得图片数量超出最大限制!"):d.length+e.length>c?$("#messagebox").message("您选择得图片数量超出最大限制!"):
($("#gallery_modal").modal("hide"),a.before(l))}else 0<e.length?(a.find(".img-put").empty().append(g),a.find("input").val(k),$("#gallery_modal").modal("hide")):$("#messagebox").message("请选择图片!")});$("#gallery_modal").on("hide.bs.modal",function(a){$(this).removeData("bs.modal")});$("#gallery_modal").on("click",".thumbnail",function(a){a.preventDefault();var f=$(this),c=f.find(".caption").attr("data-name");b&&"true"==b?$(this).toggleClass("checked"):($(this).parent().siblings().find(".thumbnail").removeClass("checked"),
$(this).addClass("checked"));$(d).each(function(a,b){$(b).find('input[name^="list"]').val()==c&&($("#messagebox").message("您已经选择了该图片!"),f.removeClass("checked"))})});$(".note-image-dialog").on("click",".action-save",function(){var a=$(".note-image-dialog").find(".checked");a.find("img").attr("src");0<a.length?$(".note-image-dialog").modal("hide"):$("#messagebox").message("请选择图片!")});$(".note-image-dialog").on("click",".thumbnail",function(){$(this).parent().parent().find(".thumbnail").removeClass("checked");
$(this).addClass("checked");var a=$(".note-image-dialog").find(".checked").find(".caption").attr("data-name");$(this).parents(".modal-body").find(".note-image-url").val(a)});$(".multiple-upload").on("click",".multiple-del",function(){$(this).parents(".multiple-upload").find(".multiple-add").show();$(this).parent().remove()})});var left_side_width=220;
$(function(){function a(){var a=$(window).height()-($("body > .header").outerHeight()||0)-($("body > .footer").outerHeight()||0),b=$(".wrapper").height();$(".wrapper").css("min-height",a);$(".left-side, html, body").css("min-height",Math.max(b,a))}$("[data-toggle='offcanvas']").click(function(a){a.preventDefault();992>=$(window).width()?($(".row-offcanvas").toggleClass("active"),$(".left-side").removeClass("collapse-left"),$(".right-side").removeClass("strech"),$(".row-offcanvas").toggleClass("relative")):($(".left-side").toggleClass("collapse-left"),
$(".right-side").toggleClass("strech"))});$(".btn").bind("touchstart",function(){$(this).addClass("hover")}).bind("touchend",function(){$(this).removeClass("hover")});$("[data-toggle='tooltip']").tooltip();$("[data-widget='collapse']").click(function(){var a=$(this).parents(".box").first(),b=a.find(".box-body, .box-footer");a.hasClass("collapsed-box")?(a.removeClass("collapsed-box"),$(this).children(".fa-plus").removeClass("fa-plus").addClass("fa-minus"),b.slideDown()):(a.addClass("collapsed-box"),
$(this).children(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),b.slideUp())});$(".navbar .menu").slimscroll({height:"200px",alwaysVisible:!1,size:"3px"}).css("width","100%");$('.btn-group[data-toggle="btn-toggle"]').each(function(){var a=$(this);$(this).find(".btn").click(function(b){a.find(".btn.active").removeClass("active");$(this).addClass("active");b.preventDefault()})});$("[data-widget='remove']").click(function(){$(this).parents(".box").first().slideUp()});$(".sidebar .treeview").tree();
a();$(window).resize(function(){a();fix_sidebar()});fix_sidebar();$("form:not([novalidate])").Validator({icons:{valid:"icon icon-checkmark-a",invalid:"icon icon-alert",validating:"icon icon-loading-c"}});$("body").on("click",".show-pics a",function(a){a.preventDefault();if(a=$(this).attr("href"))$("#show_img_madal").modal("show"),$("#big_img").attr("src",a);else return!1})});
function fix_sidebar(){$("body").hasClass("fixed")&&$(".sidebar").slimscroll({height:$(window).height()-$(".header").height()+"px",color:"rgba(0,0,0,0.2)"})}
(function(a){a.fn.boxRefresh=function(c){function b(a){a.append(d);f.onLoadStart.call(a)}var f=a.extend({trigger:".refresh-btn",source:"",onLoadStart:function(a){},onLoadDone:function(a){}},c),d=a('<div class="overlay"></div><div class="loading-img"></div>');return this.each(function(){if(""===f.source)console&&console.log("Please specify a source first - boxRefresh()");else{var c=a(this);c.find(f.trigger).first().click(function(a){a.preventDefault();b(c);c.find(".box-body").load(f.source,function(){c.find(d).remove();
f.onLoadDone.call(c)})})}})}})(jQuery);
(function(a){a.fn.tree=function(){return this.each(function(){var c=a(this).children("a").first(),b=a(this).children(".treeview-menu").first(),f=a(this).hasClass("active");f&&(b.show(),c.children(".fa-angle-left").first().removeClass("fa-angle-left").addClass("fa-angle-down"));c.click(function(a){a.preventDefault();f?(b.slideUp(),f=!1,c.children(".fa-angle-down").first().removeClass("fa-angle-down").addClass("fa-angle-left"),c.parent("li").removeClass("active")):(b.slideDown(),f=!0,c.children(".fa-angle-left").first().removeClass("fa-angle-left").addClass("fa-angle-down"),
c.parent("li").addClass("active"))});b.find("li > a").each(function(){var f=parseInt(a(this).css("margin-left"))+10;a(this).css({"margin-left":f+"px"})})})}})(jQuery);
(function(a){jQuery.fn.center=function(c){c=a.extend(!0,{},c);parent=c.parent?this.parent().css("position","relative"):window;this.css({top:"top"===c.top?0:c.top?c.top:(a(parent).height()-this.outerHeight())/2+a(parent).scrollTop()+"px",left:"left"===c.left?0:c.left?c.left:(a(parent).width()-this.outerWidth())/2+a(parent).scrollLeft()+"px"});return this}})(jQuery);
(function(a){a.fn.message=function(c,b,f,d){var e=this;this.data("timer")&&(clearTimeout(this.data("timer")),this.timer=null);this[0].className=this[0].className.replace(/alert-(success|error|warning|info|danger)/g,"");this.html(c).addClass("alert-"+(b||"error"));c=a("header.header").size()?a("header.header").height():"top";this.fadeIn("fast").center({top:c});this.data("timer",setTimeout(function(){e.fadeOut("fast")},f||3E3))}})(jQuery);
(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):"object"===typeof exports?module.exports=a:a(jQuery)})(function(a){function c(a,b,c){var g="over"==b;a.addEventListener("OverflowEvent"in window?"overflowchanged":b+"flow",function(a){if(a.type==b+"flow"||0==a.orient&&a.horizontalOverflow==g||1==a.orient&&a.verticalOverflow==g||2==a.orient&&a.horizontalOverflow==g&&a.verticalOverflow==g)return a.flow=b,c.call(this,a)},!1)}function b(f){var b=f||window.event,c=[].slice.call(arguments,
1);f=a.event.fix(b);f.type="resize";c.unshift(f);return(a.event.dispatch||a.event.handle).apply(this,c)}a.event.special.resize={setup:function(){var a=this,d="onresize"in a;if(!d&&!a._resizeSensor){var e=a._resizeSensor=document.createElement("div");e.className="resize-sensor";e.innerHTML='<div class="resize-overflow"><div></div></div><div class="resize-underflow"><div></div></div>';var g=0,k=0,l=e.firstElementChild.firstChild,n=e.lastElementChild.firstChild,p=function(b){var c=!1,d=a.offsetWidth;
g!=d&&(l.style.width=d-1+"px",n.style.width=d+1+"px",c=!0,g=d);d=a.offsetHeight;k!=d&&(l.style.height=d-1+"px",n.style.height=d+1+"px",c=!0,k=d);if(c&&b.currentTarget!=a){b={};c=document.createEvent("Event");c.initEvent("resize","bubbles"in b?b.bubbles:!0,"cancelable"in b?b.cancelable:!0);for(var e in void 0)c[e]=(void 0)[e];a.dispatchEvent(c)}};"static"==getComputedStyle(a).position&&(a.style.position="relative",a._resizeSensor._resetPosition=!0);c(e,"over",p);c(e,"under",p);c(e.firstElementChild,
"over",p);c(e.lastElementChild,"under",p);a.appendChild(e);p({})}var q=a._flowEvents||(a._flowEvents=[]);-1==q.indexOf(b)&&q.push(b);d||a.addEventListener("resize",b,!1);a.onresize=function(b){q.forEach(function(c){c.call(a,b)})}},teardown:function(){var a=this._flowEvents.indexOf(b);-1<a&&this._flowEvents.splice(a,1);if(!this._flowEvents.length){if(a=this._resizeSensor)this.removeChild(a),a._resetPosition&&(this.style.position="static"),delete this._resizeSensor;"onresize"in this&&(this.onresize=
null);delete this._flowEvents}this.removeEventListener("resize",b)}};a.fn.extend({resize:function(a){return a?this.bind("resize",a):this.trigger("resize")},unresize:function(a){return this.unbind("resize",a)}})});
(function(a){jQuery.fn.extend({slimScroll:function(c){var b=a.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:0.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:0.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"0px",railBorderRadius:"0px"},c);this.each(function(){function f(c){if(n){c=c||
window.event;var f=0;c.wheelDelta&&(f=-c.wheelDelta/120);c.detail&&(f=c.detail/3);a(c.target||c.srcTarget||c.srcElement).closest("."+b.wrapperClass).is(h.parent())&&d(f,!0);c.preventDefault&&!v&&c.preventDefault();v||(c.returnValue=!1)}}function d(a,c,f){v=!1;var d=a,e=h.outerHeight()-m.outerHeight();c&&(d=parseInt(m.css("top"))+a*parseInt(b.wheelStep)/100*m.outerHeight(),d=Math.min(Math.max(d,0),e),d=0<a?Math.ceil(d):Math.floor(d),m.css({top:d+"px"}));u=parseInt(m.css("top"))/(h.outerHeight()-m.outerHeight());
d=u*(h[0].scrollHeight-h.outerHeight());f&&(d=a,a=d/h[0].scrollHeight*h.outerHeight(),a=Math.min(Math.max(a,0),e),m.css({top:a+"px"}));h.scrollTop(d);h.trigger("slimscrolling",~~d);k();l()}function e(){window.addEventListener?(this.addEventListener("DOMMouseScroll",f,!1),this.addEventListener("mousewheel",f,!1),this.addEventListener("MozMousePixelScroll",f,!1)):document.attachEvent("onmousewheel",f)}function g(){r=Math.max(h.outerHeight()/h[0].scrollHeight*h.outerHeight(),B);m.css({height:r+"px"});
var a=r==h.outerHeight()?"none":"block";m.css({display:a})}function k(){g();clearTimeout(y);u==~~u?(v=b.allowPageScroll,A!=u&&h.trigger("slimscroll",0==~~u?"top":"bottom")):v=!1;A=u;r>=h.outerHeight()?v=!0:(m.stop(!0,!0).fadeIn("fast"),b.railVisible&&w.stop(!0,!0).fadeIn("fast"))}function l(){b.alwaysVisible||(y=setTimeout(function(){b.disableFadeOut&&n||p||q||(m.fadeOut("slow"),w.fadeOut("slow"))},1E3))}var n,p,q,y,s,r,u,A,B=30,v=!1,h=a(this);if(h.parent().hasClass(b.wrapperClass)){var x=h.scrollTop(),
m=h.parent().find("."+b.barClass),w=h.parent().find("."+b.railClass);g();if(a.isPlainObject(c)){if("height"in c&&"auto"==c.height){h.parent().css("height","auto");h.css("height","auto");var z=h.parent().parent().height();h.parent().css("height",z);h.css("height",z)}if("scrollTo"in c)x=parseInt(b.scrollTo);else if("scrollBy"in c)x+=parseInt(b.scrollBy);else if("destroy"in c){m.remove();w.remove();h.unwrap();return}d(x,!1,!0)}}else b.height="auto"==b.height?h.parent().height():b.height,x=a("<div></div>").addClass(b.wrapperClass).css({position:"relative",
overflow:"hidden",width:b.width,height:b.height}),h.css({overflow:"hidden",width:b.width,height:b.height}),w=a("<div></div>").addClass(b.railClass).css({width:b.size,height:"100%",position:"absolute",top:0,display:b.alwaysVisible&&b.railVisible?"block":"none","border-radius":b.railBorderRadius,background:b.railColor,opacity:b.railOpacity,zIndex:90}),m=a("<div></div>").addClass(b.barClass).css({background:b.color,width:b.size,position:"absolute",top:0,opacity:b.opacity,display:b.alwaysVisible?"block":
"none","border-radius":b.borderRadius,BorderRadius:b.borderRadius,MozBorderRadius:b.borderRadius,WebkitBorderRadius:b.borderRadius,zIndex:99}),z="right"==b.position?{right:b.distance}:{left:b.distance},w.css(z),m.css(z),h.wrap(x),h.parent().append(m),h.parent().append(w),b.railDraggable&&m.bind("mousedown",function(b){var c=a(document);q=!0;t=parseFloat(m.css("top"));pageY=b.pageY;c.bind("mousemove.slimscroll",function(a){currTop=t+a.pageY-pageY;m.css("top",currTop);d(0,m.position().top,!1)});c.bind("mouseup.slimscroll",
function(a){q=!1;l();c.unbind(".slimscroll")});return!1}).bind("selectstart.slimscroll",function(a){a.stopPropagation();a.preventDefault();return!1}),w.hover(function(){k()},function(){l()}),m.hover(function(){p=!0},function(){p=!1}),h.hover(function(){n=!0;k();l()},function(){n=!1;l()}),h.bind("touchstart",function(a,b){a.originalEvent.touches.length&&(s=a.originalEvent.touches[0].pageY)}),h.bind("touchmove",function(a){v||a.originalEvent.preventDefault();a.originalEvent.touches.length&&(d((s-a.originalEvent.touches[0].pageY)/
b.touchScrollStep,!0),s=a.originalEvent.touches[0].pageY)}),g(),"bottom"===b.start?(m.css({top:h.outerHeight()-m.outerHeight()}),d(0,!0)):"top"!==b.start&&(d(a(b.start).position().top,null,!0),b.alwaysVisible||m.hide()),e()});return this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery);
(function(a){if(!window.localStorage||!window.JSON)return a.fn.rememberState=function(){return this};var c={name:"rememberState",clearOnSubmit:!0,ignore:null,use_ids:!1,mark:null,restoreState:function(a){var b=JSON.parse(localStorage.getItem(this.mark)),c=this.$el,g,k;for(k in b)g=c.find('[name="'+b[k].name+'"]'),g.is(":radio")?g.filter('[value="'+b[k].value+'"]').prop("checked",!0):g.is(":checkbox")&&b[k].value?g.prop("checked",!0):g.is("select")?g.find('[value="'+b[k].value+'"]').prop("selected",
!0):g.val(b[k].value),g.change();a&&a.preventDefault&&a.preventDefault()},saveState:function(c){c=c.data.instance;var d=c.$el.serializeArray();c.$el.find("input[type='datetime-local']").each(function(){var b=a(this);d.push({name:b.attr("name"),value:b.val()})});d=c.removeIgnored(d);d.length&&b.setObject(c.mark,d)},save:function(){var a=this;this.saveState||(a=this.data(c.name));a.saveState({data:{instance:a}})},removeIgnored:function(b){var c=this.ignore;if(!c)return b;a.each(b,function(e,g){-1!==
a.inArray(g.name,c)&&(b[e]=!1)});return b=a.grep(b,function(a){return a})},setName:function(){(this.mark=this.mark||this.$el.attr("id"))||console.warn("No form ID or other mark.");this.mark="rememberstate_"+this.mark},bindResetEvents:function(){var b=this;this.clearOnSubmit&&this.$el.bind("submit."+this.name,function(){a(this).trigger("reset_state");a(window).unbind("unload."+b.name)});this.$el.bind("reset_state."+this.name,function(){localStorage.removeItem(b.mark)});this.$el.find(":reset").bind("click."+
this.name,function(){a(this).closest("form").trigger("reset_state")})},destroy:function(b){var c="."+this.name;this.$el.unbind(c).find(":reset").unbind(c);a(window).unbind(c);b&&localStorage.removeItem(this.mark)},init:function(){this.setName();this.mark&&(this.bindResetEvents(),a(window).bind("unload."+this.name,{instance:this},this.saveState))}},b={setObject:function(a,b){localStorage[a]=JSON.stringify(b)},getObject:function(a){return JSON.parse(localStorage[a])},createPlugin:function(b){a.fn[b.name]=
function(c){var e=this,g=a.isPlainObject(c)||!c?"":c,k=arguments;g&&b[g]?e.each(function(a){b[g].apply(e.eq(a).data(b.name),Array.prototype.slice.call(k,1))}):g?a.error("Method "+g+" does not exist on jQuery."+b.name):e.each(function(g){var k=a.extend(!0,{$el:e.eq(g)},b,c);e.eq(g).data(b.name,k);k.init()});return e}}};b.createPlugin(c)})(jQuery);var goodsChoose=function(a){a=$.extend({url:"",getProUrl:"",getBrandUrl:"",getGoodsUrl:"",target:document.body,modalDom:"#goods_modal",handle:".select-goods",catBox:"#goods_category",catlistItem:"#goods_category li",catDefault:"分类",brandBox:"#goods_brand",brandList:"#brand_list",brandListItem:"#brand_list li",brandDefault:"品牌",filterBtn:"#search_goods",clearFilterBtn:"#clear_filter",clearBrandBtn:"#clear_brand",submitBtn:"#choose_goods",goodsList:"#goods_list",goodsListItem:"#goods_list > ul > li",
goodsSearchKey:"#goods-search-key",insertWhere:null,textcol:null,view:null,getPro:function(a,b,c,d,e,f){$.ajax({url:b,type:"POST",dataType:"html",data:{searchname:e,catId:c,brandId:d},success:function(b){$(a).html(b);if(f)return f()}})},getBrand:function(a,b,c){""!=b&&$.ajax({url:a,type:"POST",dataType:"json",data:{catId:b},success:function(a){if(a){for(var b="",d=0;d<a.length;d++)b+='<li data-val="'+a[d].brand_id+'">'+a[d].brand_name+"</li>";$(c).empty().append(b)}}})}},a||{});var c,b,f,d=[],e=$(a.handle).attr("data-remote")||
a.url,g=$(a.handle).attr("data-item_id"),k=$(a.handle).attr("data-fetchgoods")||a.getGoodsUrl;insertWhere=$(a.insertWhere||".selected-goods-list");limit=$(a.handle).data("limit")||a.limit;var l=$(a.handle).data(),n;for(n in l)(n="remote")&&delete l[n],(n="fetchgoods")&&delete l[n],(n="target")&&delete l[n],(n="limit")&&delete l[n];$(a.target).on("click",a.handle,function(b){b.preventDefault();b=$(this).parents(".select-goods-panel");insertWhere=$(b).find(this.getAttribute("data-insertwhere")||a.insertWhere||
".selected-goods-list");$(a.modalDom).modal("show")});$(function(){if(g&&0<g.length)$.post(k,l,function(a){a&&$(insertWhere).html(a)});else return!1});$(a.modalDom).on("show.bs.modal",function(){d=[];var a=$(insertWhere).find("tr");$(a).each(function(a,b){d.push($(b).attr("date-itemid"))});$(this).find(".modal-content").load(e)}).on("shown.bs.modal",function(){c=$(a.filterBtn).attr("data-remote")||a.getProUrl;a.getPro(a.goodsList,c,"","","",function(){for(var b=$(a.goodsList).find("li"),c=0;c<b.length;c++)for(var e=
$(b[c]).attr("data-id"),f=0;f<d.length;f++)e==d[f]&&$(b[c]).addClass("checked")})}).on("hide.bs.modal",function(){a.getPro(a.goodsList,c)}).on("click",a.catlistItem,function(){if($(this).attr("data-val")){b=$(this).attr("data-val");var c=$(a.brandBox).attr("data-remote")||a.getBrandUrl,d=$(this).text();a.getBrand(c,b,a.brandList);$(this).parents(".filters-list").hide().siblings(".filter-name").text(d);$(a.brandBox).find(".filter-name").text(a.brandDefault)}}).on("click",a.brandListItem,function(){f=
$(this).attr("data-val");var a=$(this).text();$(this).parents(".filters-list").hide().siblings(".filter-name").text(a)}).on("click",a.filterBtn,function(){var d=$(this).parent().find('input[type="text"]').val();a.getPro(a.goodsList,c,b,f,d)}).on("click",a.goodsListItem,function(){$(this).toggleClass("checked");var b=$(this).attr("data-id");if($(this).hasClass("checked")){if(limit){if("number"===typeof limit&&0<parseInt(limit))limit=parseInt(limit);else return;if($(a.goodsList).find(".checked").length>
limit){$("#messagebox").message("最多只能选择"+limit+"个商品");$(this).removeClass("checked");return}}d.push(b)}else for(var c=0;c<d.length;c++)d[c]==b&&d.splice(c,1)}).on("mouseover mouseout",a.catBox,function(a){var b=$(this).children(".filters-list");"mouseover"==a.type?b.show():"mouseout"==a.type&&b.hide()}).on("mouseover mouseout",a.brandBox,function(){var a=$(this).children(".filters-list");"mouseover"==event.type?a.show():"mouseout"==event.type&&a.hide()}).on("mouseover mouseout",a.catlistItem,function(){var a=
$(this).children(".child-list");$(a)&&("mouseover"==event.type?a.show():"mouseout"==event.type&&a.hide())}).on("click",a.clearFilterBtn,function(e){e.preventDefault();f=b=null;$(a.catBox).find(".filter-name").text(a.catDefault);$(a.brandBox).find(".filter-name").text(a.brandDefault);$(a.brandList).empty();$(a.goodsSearchKey).val("");c=$(a.filterBtn).attr("data-remote")||a.getProUrl;a.getPro(a.goodsList,c,"","","",function(){for(var b=$(a.goodsList).find("li"),c=0;c<b.length;c++)for(var e=$(b[c]).attr("data-id"),
f=0;f<d.length;f++)e==d[f]&&$(b[c]).addClass("checked")})}).on("click",a.clearBrandBtn,function(b){b.preventDefault();f=null;$(a.brandBox).find(".filter-name").text(a.brandDefault)}).on("click",a.submitBtn,function(){0==d.length?$("#messagebox").message("请选择商品"):(l=$.extend(l,{item_id:d}),$.post(k,l,function(b){b?($(insertWhere).html(b),$(a.modalDom).modal("hide")):$("#messagebox").message("还未添加商品")}))}).on("click",".pagination a",function(b){b.preventDefault();$(this).parent().hasClass("disabled")||
$.post($(this).attr("href"),function(b){$(a.goodsList).html(b);b=$(a.goodsList).find("li");for(var c=0;c<b.length;c++)for(var f=$(b[c]).attr("data-id"),e=0;e<d.length;e++)f==d[e]&&$(b[c]).addClass("checked")})})};$(function(){goodsChoose()});